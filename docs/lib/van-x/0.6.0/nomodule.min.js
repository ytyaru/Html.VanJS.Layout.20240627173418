{let e,t,r,{fromEntries:o,entries:l,keys:n,hasOwn:f,getPrototypeOf:i}=Object,{get:a,set:y,deleteProperty:c,ownKeys:s}=Reflect,{state:m,derive:d,add:u}=van,b=1e3,w=Symbol(),A=Symbol(),S=Symbol(),_=Symbol(),g=Symbol(),p=Symbol(),P=e=>(e[A]=1,e),h=e=>e instanceof Object&&!(e instanceof Function)&&!e[p],v=e=>{if(e?.[A]){let t=m();return d(()=>{let r=e();h(t.rawVal)&&h(r)?T(t.rawVal,r):t.val=O(r)}),t}return m(O(e))},F=e=>{let t=Array.isArray(e)?[]:{__proto__:i(e)};for(let[r,o]of l(e))t[r]=v(o);return t[S]=[],t[_]=m(1),t},O=e=>!h(e)||e[w]?e:new Proxy(F(e),{get:(e,t,r)=>t===w?e:f(e,t)?Array.isArray(e)&&"length"===t?(e[_].val,e.length):e[t].val:a(e,t,r),set:(e,o,l,n)=>f(e,o)?Array.isArray(e)&&"length"===o?(l!==e.length&&++e[_].val,e.length=l,1):(e[o].val=O(l),1):o in e?y(e,o,l,n):y(e,o,v(l))&&(++e[_].val,K(e).forEach(N.bind(t,n,o,e[o],r)),1),deleteProperty:(e,t)=>(c(e,t)&&k(e,t),++e[_].val),ownKeys:e=>(e[_].val,s(e))}),D=e=>(e[p]=1,e),j=e=>e[w],x=e=>e[w]?new Proxy(e[w],{get:(e,t)=>x(e[t].rawVal)}):e,K=e=>e[S]=e[S].filter(e=>e.t.isConnected),N=(e,t,r,o,{t:l,f:f})=>{let i=Array.isArray(e),a=i?Number(t):t;u(l,()=>l[g][t]=f(r,()=>delete e[t],a)),i&&!o&&a!==e.length-1&&l.insertBefore(l.lastChild,l[g][n(e).find(e=>Number(e)>a)])},k=(e,t)=>{for(let r of K(e)){let e=r.t[g];e[t]?.remove(),delete e[t]}},C=r=>(e??(setTimeout(()=>(e.forEach(K),e=t),b),e=new Set)).add(r),E=(e,t,r)=>{let o={t:e instanceof Function?e():e,f:r},n=t[w];o.t[g]={},n[S].push(o),C(n);for(let[e,r]of l(n))N(t,e,r,1,o);return o.t},R=(e,t)=>{for(let[r,o]of l(t)){let t=e[r];h(t)&&h(o)?R(t,o):e[r]=o}for(let r in e)f(t,r)||delete e[r];let r=n(t),o=Array.isArray(e);if(o||n(e).some((e,t)=>e!==r[t])){let l=e[w];if(o)e.length=t.length;else{++l[_].val;let e={...l};for(let e of r)delete l[e];for(let t of r)l[t]=e[t]}for(let{t:e}of K(l)){let{firstChild:t,[g]:o}=e;for(let l of r)t===o[l]?t=t.nextSibling:e.insertBefore(o[l],t)}}return e},T=(e,n)=>{r=1;try{return R(e,n instanceof Function?Array.isArray(e)?n(e.filter(e=>1)):o(n(l(e))):n)}finally{r=t}},q=e=>Array.isArray(e)?e.filter(e=>1).map(q):h(e)?o(l(e).map(([e,t])=>[e,q(t)])):e;window.vanX={calc:P,reactive:O,noreactive:D,stateFields:j,raw:x,list:E,replace:T,compact:q}}
